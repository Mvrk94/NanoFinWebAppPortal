var app=angular.module("myApp",["ngRoute","ngMap"]);app.config(function($routeProvider,$locationProvider){$routeProvider.when("/",{redirectTo:function(){return"/home"}}).when("/home",{title:"Insurance Manager",templateUrl:"/views/components/InsuranceManager/home.html",controller:"homePageController"}).when("/ProductManagement",{title:"Insurance Manager",templateUrl:"/views/components/InsuranceManager/productManagement.html",controller:"productManagementPageController"}).when("/Products",{title:"Insurance Manager",templateUrl:"/views/components/InsuranceManager/products.html",controller:"productsPageController"}).when("/addProduct",{title:"Insurance Manager",templateUrl:"/views/components/InsuranceManager/AddInsuranceProduct.html",controller:"AddProductPageController"}).when("/ProcessPurchases",{title:" home",templateUrl:"/views/components/InsuranceManager/viewiunprocessedapplications.html",controller:"insuranceApplicationsPageController"}).when("/Reports",{title:"reports",templateUrl:"/views/components/InsuranceManager/reports.html"}).when("/validate",{title:"validate",templateUrl:"/views/components/home/validatorUsers.html"}).when("/test",{title:"validate",templateUrl:"/views/components/test/test.html"}).when("/mapLocation",{title:"maps",templateUrl:"/views/components/test/GeoReports.html"}).otherwise({templateUrl:"/views/components/InsuranceManager/home.html",controller:"homePageController"}),$locationProvider.html5Mode(!0)}),app.controller("homePageController",["$scope",function($scope){}]),app.controller("aboutPageController",["$scope",function($scope){}]),app.controller("productManagementPageController",["$scope",function($scope){}]),app.controller("productsPageController",["$scope",function($scope){}]),app.controller("AddProductPageController",["$scope",function($scope){}]),app.controller("contactPageController",["$scope",function($scope){$scope.title="contact"}]),app.controller("insuranceApplicationsPageController",["$scope",function($scope){}]),app.run(["$rootScope","$route",function($rootScope,$route){$rootScope.$on("$routeChangeSuccess",function(){document.title=$route.current.title})}]),angular.module("myApp").controller("reportsNaster",["$scope","$http","$compile",function($scope,$http,$compile){var insurancetypeIDs=[1,2,11,21,31],insurancetypeNames=["Assets","Travel","Legal","Medical","Funeral"];$scope.getType=function(insuranceType){return 1==insuranceType?"Assets":2==insuranceType?"Travel":11==insuranceType?"Legal":21==insuranceType?"Medical":31==insuranceType?"Funeral":"Value Added"},$scope.reportName=" ",$scope.shortdescription="";var fillInsuranceType=function(){for(var result="",insurancetypeIDs=[1,2,11,21,31],c=0;c<insurancetypeIDs.length;c++)result+="\t<li  style='margin-bottom:9px;width:280px'>",result+="\t<div class='row'>",result+="\t<div class='col-sm-1 col-sm-push-1 removePersonalSpace'>",result+="<label><input type='checkbox' id='checkbox"+insurancetypeIDs[c]+"' class='flat-red'></label>",result+="\t</div>",result+="",result+="\t<div class='col-sm-7 col-sm-push-1 removePersonalSpace' style='width:250px'>",result+=String(insurancetypeNames[c])+" <br />",result+="<span style='font-size:12px'>.</span>",result+="</div>",result+="</div>",result+="</li>";result+="<li style='font-size:19px' >  <br /> <br /></li>";var element=document.getElementById("itemList");element.innerHTML=result,$('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({checkboxClass:"icheckbox_flat-green"})},insurnaceTypeSelected=[],canDraw=0,canDrawInsuranceType=0,errorCallBack=function(response){$scope.products=response.data},saveItemInformartion=function(response){$scope.itemsData=response,document.getElementById("drawReport").style.visibility="hidden"},setTargetSales=function(responce){$scope.targetInfor=responce},setProduct1=function(responce){$scope.product1data=responce.data,canDraw+=1,canDraw%2===0&&drawCompareProducts()},setProduct2=function(responce){$scope.product2data=responce.data,canDraw+=1,canDraw%2===0&&drawCompareProducts()},fillOptions=function(){for(var result="",data=$scope.itemsData.data,c=0;c<data.length;c++)result+="\t<li  style='margin-bottom:9px;width:280px'>",result+="\t<div class='row'>",result+="\t<div class='col-sm-1 col-sm-push-1 removePersonalSpace'>",result+="<label><input type='checkbox' id='checkbox"+data[c].Product_ID+"' class='flat-red'></label>",result+="\t</div>",result+="",result+="\t<div class='col-sm-7 col-sm-push-1 removePersonalSpace' style='width:250px'>",result+=String(data[c].name)+" <br />",result+="<span style='font-size:12px'>"+$scope.getType(data[c].InsuranceType_ID)+"</span>",result+="</div>",result+="</div>",result+="</li>";result+="<li style='font-size:19px' >  <br /> <br /></li>";var element=document.getElementById("itemList");element.innerHTML=result,$('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({checkboxClass:"icheckbox_flat-green"})};$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/getProductList"}).then(saveItemInformartion,errorCallBack),$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/TargetProgrees?productProvider=11&numMonths=1"}).then(setTargetSales,errorCallBack),$scope.targetSales=function(){document.getElementById("drawReport").style.visibility="visible",turnOnMainList("btntargetSales"),document.getElementById("insertCanvas").innerHTML="",fillOptions(),$scope.reportName="Current  Month  sales  vs  Target  sales",$scope.shortdescription=" The graph below compares the selected product’s sales with target sales that you set for this month. Sales are in Rands.",document.getElementById("drawReport").onclick=function(){$scope.reportName="Current  Month  sales  vs  Target  sales",$scope.shortdescription=" The graph below compares the selected product’s sales with target sales that you set for this month. Sales are in Rands.",$scope.drawTargetToCanvas()}},$scope.drawTargetToCanvas=function(){document.getElementById("insertCanvas").innerHTML="<canvas  class='chart' id='canvasData' style='height:385px;width:830px;marign-left:29px;'></canvas>";var responce=$scope.targetInfor,drawItems=[],index=0,i=0;for(var tmep in responce.data){var check=document.getElementById("checkbox"+responce.data[index].ProductID).checked;check===!0&&(i++,drawItems.push(responce.data[index])),index++}var labels=[],sales=[],target=[],counter=0;for(var v in drawItems){var temp=drawItems[counter];labels.push(temp.name+" in ZAR"),sales.push(temp.currentSales),target.push(temp.targetSales),counter++}var areaChartData={labels:labels,datasets:[{label:"Sales",fillColor:"#FF9966",strokeColor:"#FF9966",pointColor:"#FF9966",pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:"#FF9966",data:sales},{label:"Target",fillColor:"rgba(210, 214, 222, 1)",strokeColor:"rgba(210, 214, 222, 1)",pointColor:"rgba(210, 214, 222, 1)",pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:target}]};document.getElementById("canvasData").innerHTML=0;var barChartCanvas=$("#canvasData").get(0).getContext("2d"),barChart=new Chart(barChartCanvas),barChartData=areaChartData,color2="#79BEDB";barChartData.datasets[1].fillColor=color2,barChartData.datasets[1].strokeColor=color2,barChartData.datasets[1].pointColor=color2;var barChartOptions={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:8,isFixedWidth:!1,barWidth:10,title:"sacacasc ascacs",legend:{display:!0},tooltips:{enabled:!1},barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',responsive:!0,maintainAspectRatio:!0};barChartOptions.datasetFill=!1,barChart.Bar(barChartData,barChartOptions)};var drawCompareProducts=function(){var datasets=[],counter=0;counter=parseInt(String($scope.product1data.previouse.length))-7,counterp2=parseInt(String($scope.product2data.previouse.length))-7;var name1=$scope.product1data.name+" in ZAR",name2=$scope.product2data.name+" in ZAR";$scope.reportName=$scope.product1data.name+"  Sales vs  "+$scope.product2data.name+"  Sales",$scope.shortdescription=" The graph below compares the two select product sales. The last six months sales together with the forecasted sales of each selected product. Sales are in Rands.";for(var year=6,month=3,str="",n=0;n<6;n++)str=String("201"+String(year)+"-"+String(month)),datasets.push({period:str,licensed:parseFloat($scope.product1data.previouse[counter]).toFixed(2),sorned:parseFloat($scope.product2data.previouse[counterp2]).toFixed(2)}),month++,counter++,counterp2++,12==month&&(year++,month=1);counter=0,canDrawInsuranceType=0;for(var y=0;y<6;y++)str=String("201"+String(year)+"-"+String(month)),datasets.push({period:str,licensed:parseFloat($scope.product1data.predictions[counter]).toFixed(2),sorned:parseFloat($scope.product2data.predictions[counter]).toFixed(2)}),month++,counter++,12==month&&(year++,month=1);new Morris.Line({element:"canvasData",resize:!0,data:datasets,xkey:"period",ykeys:["licensed","sorned"],labels:[name1,name2],lineWidth:2,hideHover:"auto",gridStrokeWidth:.4,pointSize:4,gridTextFamily:"Open Sans",gridTextSize:10})};$scope.compareProuctsCanvas=function(){document.getElementById("drawReport").style.visibility="visible",fillOptions(),turnOnMainList("btnCompareProducts"),document.getElementById("insertCanvas").innerHTML="",$scope.reportName="Compare  Two  Products",$scope.shortdescription=" The graph will  show the two select product sales. The last six months sales together with the forecasted sales of each selected product. Sales are in Rands.",document.getElementById("drawReport").onclick=function(){document.getElementById("insertCanvas").innerHTML="<div  class='chart' id='canvasData' style='height:385px;width:840px;marign-left:29px;'></div>";for(var drawItems=[],index=0,productlist=$scope.itemsData.data,found=0,prod=0;prod<productlist.length&&found<2;prod++){var check=document.getElementById("checkbox"+productlist[index].Product_ID).checked;check===!0&&(found++,drawItems.push(productlist[index].Product_ID)),index++}$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/getProductSalesPredictions?productID="+drawItems[0]+"&numPredictions=7"}).then(setProduct1,errorCallBack),$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/getProductSalesPredictions?productID="+drawItems[1]+"&numPredictions=7"}).then(setProduct2,errorCallBack)}};var SetinsuranceTypeData=function(responce){$scope.insuranceTypedata=responce.data,drawcurrentMonthInsuranceType(responce.data)};$scope.insuranceTypeSales=function(responce){document.getElementById("drawReport").style.visibility="hidden",document.getElementById("itemList").innerHTML="",document.getElementById("insertCanvas").innerHTML="",$scope.reportName="",turnOnMainList("btnOverallInsuranceTypes"),$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/getLastMonthInsuranceTypeSales"}).then(SetinsuranceTypeData,errorCallBack)};var drawcurrentMonthInsuranceType=function(responce){$scope.reportName="Current  Month  Insurance  Type  Sales",$scope.shortdescription=" The graph below displays each insurance type sales for the current month. Sales are in Rands",document.getElementById("insertCanvas").innerHTML="<canvas  class='chart' id='canvasData' style='height:385px;width:830px;marign-left:29px;'></canvas>";var labels=[],sales=[],counter=0;for(var v in responce){var temp=responce[counter];labels.push($scope.getType(temp.InsuranceType_ID)),sales.push(temp.monthSales),counter++}var areaChartData={labels:labels,datasets:[{label:"Sales",fillColor:"#FF9966",strokeColor:"#FF9966",pointColor:"#FF9966",pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:"#FF9966",data:sales}]};document.getElementById("canvasData").innerHTML=0;var barChartCanvas=$("#canvasData").get(0).getContext("2d"),barChart=new Chart(barChartCanvas),barChartData=areaChartData,barChartOptions={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:20,isFixedWidth:!0,barWidth:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',responsive:!0,maintainAspectRatio:!0};barChartOptions.datasetFill=!1,barChart.Bar(barChartData,barChartOptions)},setinsurance1=function(responce){$scope.insurace1data=responce.data,canDrawInsuranceType+=1,canDrawInsuranceType%2===0&&drawCompareInsuranceType()},setinsurance2=function(responce){$scope.insurace2data=responce.data,canDrawInsuranceType+=1,canDrawInsuranceType%2===0&&drawCompareInsuranceType()};$scope.compareInsuranceTypes=function(){fillInsuranceType(),turnOnMainList("btnCompareType"),document.getElementById("insertCanvas").innerHTML="",document.getElementById("insertCanvas").innerHTML="<div  class='chart' id='canvasData' style='height:385px;width:840px;marign-left:29px;'></div>",document.getElementById("drawReport").style.visibility="visible",$scope.reportName="Compare  Insurance  Types  Sales",$scope.shortdescription="The graph below compares two insurance type sales. Its shows sales from the last six and forecasts the next Six.",document.getElementById("drawReport").onclick=function(){for(var drawItems=[],index=0,found=0,prod=0;prod<insurancetypeIDs.length&&found<2;prod++){var check=document.getElementById("checkbox"+insurancetypeIDs[index]).checked;check===!0&&(found++,drawItems.push(insurancetypeIDs[index])),index++}insurnaceTypeSelected=[],insurnaceTypeSelected.push(drawItems[0]),insurnaceTypeSelected.push(drawItems[1]),$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/PredictInsuranceTypeSales?insuranceTypeID="+drawItems[0]+"&numPredictions=6"}).then(setinsurance1,errorCallBack),$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/PredictInsuranceTypeSales?insuranceTypeID="+drawItems[1]+"&numPredictions=6"}).then(setinsurance2,errorCallBack)}};var drawCompareInsuranceType=function(){document.getElementById("insertCanvas").innerHTML="<div  class='chart' id='canvasData' style='height:385px;width:840px;marign-left:29px;'></div>";var datasets=[],counter=1;counter=parseInt(String($scope.insurace1data.previouse.length))-7;var counterp2=parseInt(String($scope.insurace2data.previouse.length))-7,name1=$scope.getType(insurnaceTypeSelected[0])+" in ZAR",name2=$scope.getType(insurnaceTypeSelected[1])+" in ZAR";$scope.reportName=$scope.getType(insurnaceTypeSelected[0])+"  Product  Sales  vs "+$scope.getType(insurnaceTypeSelected[1])+"  Product  Sales",$scope.shortdescription="The graph below compares Two insurance type sales. Its shows sales from the last Six and Forecasts the next Six.";for(var str=(new Date(Date.UTC(2015,1,1)),""),year=6,month=3,n=0;n<6;n++)str=String("201"+String(year)+"-"+String(month)),datasets.push({period:str,licensed:parseFloat($scope.insurace1data.previouse[counter]).toFixed(2),sorned:parseFloat($scope.insurace2data.previouse[counterp2]).toFixed(2)}),counter++,month++,counterp2++,12==month&&(year++,month=1);canDraw=0,counter=0;for(var y=(new Date(Date.UTC(2016,9,1)),0);y<6;y++)str=String("201"+String(year)+"-"+String(month)),datasets.push({period:str,licensed:parseFloat($scope.insurace1data.predictions[counter]).toFixed(2),sorned:parseFloat($scope.insurace2data.predictions[counter]).toFixed(2)}),month++,counter++,12==month&&(year++,month=1);new Morris.Line({element:"canvasData",resize:!0,data:datasets,xkey:"period",ykeys:["licensed","sorned"],labels:[name1,name2],lineWidth:2,hideHover:"auto",gridStrokeWidth:.4,pointSize:4,gridTextFamily:"Open Sans",gridTextSize:10,options:{title:{display:!0,text:"Custom Chart Title"}}})};$scope.viewCurrentMonthProductSales=function(){document.getElementById("drawReport").style.visibility="hidden",document.getElementById("itemList").innerHTML="",turnOnMainList("btnViewCurrentMonth"),$scope.reportName="Current Month Total Product Sales",$scope.shortdescription="The graph below displays the current month’s sales for each product. Sales are in Rands",document.getElementById("insertCanvas").innerHTML="<canvas  class='chart' id='canvasData' style='height:385px;width:830px;marign-left:29px;'></canvas>";var responce=$scope.targetInfor,drawItems=[],index=0;for(var tmep in responce.data)drawItems.push(responce.data[index]),index++;var labels=[],sales=[],target=[],counter=0;for(var v in drawItems){var temp=drawItems[counter];labels.push(temp.name+" in ZAR"),sales.push(temp.currentSales),target.push(temp.targetSales),counter++}var areaChartData={labels:labels,datasets:[{label:"Sales",fillColor:"#FF9966",strokeColor:"00BFFF",pointColor:"#FF9966",pointStrokeColor:"#00BFFF",pointHighlightFill:"#fff",pointHighlightStroke:"#FF9966",data:sales}]};document.getElementById("canvasData").innerHTML=0;var barChartCanvas=$("#canvasData").get(0).getContext("2d"),barChart=new Chart(barChartCanvas),barChartData=areaChartData,barChartOptions={scaleFontSize:0,showXAxisLabel:!1,scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:10,legend:{display:!1},tooltips:{enabled:!1},barDatasetSpacing:50,responsive:!0,maintainAspectRatio:!0};barChartOptions.datasetFill=!1,barChart.Bar(barChartData,barChartOptions)};var turnOnMainList=function(item){for(var linkedList=document.getElementById("menuList"),collection=linkedList.getElementsByTagName("li"),i=1;i<collection.length;i++)collection[i].id!==item?collection[i].className="":collection[i].className="active"}}]);var app=angular.module("myApp");app.controller("addProductController",["$scope","$http",function($scope,$http){$scope.product={Product_ID:0,ProductProvider_ID:11,ProductType_ID:1,productName:"",productDescription:"",productPolicyDocPath:"c://",isAvailableForPurchase:!0},$scope.InsuranceProduct={InsuranceProduct_ID:0,ProductProvider_ID:11,InsuranceType_ID:0,Product_ID:0,ipCoverAmount:0,ipUnitCost:0,ipUnitType:0,ipMinimunNoOfUnits:0,ipClaimInfoPath:"string"},$scope.submitProductChanges=function(){$scope.product.isAvailableForPurchase=document.getElementById("sltAvailable").value;var req={method:"POST",url:"http://nanofinapi.azurewebsites.net/api/insuranceManager/Postproduct",headers:{"Content-Type":"application/json; charset=UTF-8"},data:JSON.stringify($scope.product)};$http(req).then(function(responce,status,headers,config){$scope.InsuranceProduct.Product_ID=parseInt(String(headers("location")).replace("http://nanofinapi.azurewebsites.net/api/insuranceManager/Postproduct/","")),alert("first item sent")})},$scope.submitInsuranceProductChanges=function(){$scope.InsuranceProduct.InsuranceType_ID=document.getElementById("sltInsuranceType").value,$scope.InsuranceProduct.ipUnitType=document.getElementById("sltInsuranceType").value;var req={method:"POST",url:"http://nanofinapi.azurewebsites.net/api/insuranceManager/Postinsuranceproduct",headers:{"Content-Type":"application/json; charset=UTF-8"},data:JSON.stringify($scope.InsuranceProduct)};$http(req).then(function(responce){alert("second item sent"),$scope.InsuranceProduct.Product_ID=262})}}]),angular.module("myApp").controller("CompareProducts",["$scope","$http","$compile",function($scope,$http,$compile){$scope.getType=function(insuranceType){return 1==insuranceType?"Assets":2==insuranceType?"Travel":11==insuranceType?"Legal":21==insuranceType?"Medical":31==insuranceType?"Funeral":"Value Added"};var canDraw=0,errorCallBack=function(response){$scope.products=response.data},saveItemInformartion=function(response){$scope.itemsData=response},setTargetSales=function(responce){$scope.targetInfor=responce},setCompareProduct1=function(responce){$scope.product1data=responce.data,alert($scope.product1data.name),canDraw+=1,canDraw%2===0&&drawCompareProducts()},setCompareProduct2=function(responce){$scope.product2data=responce.data,alert($scope.product2data.name),canDraw+=1,canDraw%2===0&&drawCompareProducts()},fillOptions=function(){for(var result="",data=$scope.itemsData.data,c=0;c<data.length;c++)result+="\t<li  style='margin-bottom:9px;width:280px'>",result+="\t<div class='row'>",result+="\t<div class='col-sm-1 col-sm-push-1 removePersonalSpace'>",result+="<label><input type='checkbox' id='checkbox"+data[c].ProductID+"' class='flat-red'></label>",result+="\t</div>",result+="",result+="\t<div class='col-sm-7 col-sm-push-1 removePersonalSpace' style='width:250px'>",result+=String(data[c].name)+" <br />",result+="<span style='font-size:12px'>"+$scope.getType(data[c].insuranceType)+"</span>",result+="</div>",result+="</div>",result+="</li>";result+="<li style='font-size:19px' >  <br /> <br /></li>";var element=document.getElementById("itemList");element.innerHTML=result,$('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({checkboxClass:"icheckbox_flat-green"})};$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/getProductList"}).then(saveItemInformartion,errorCallBack),$scope.targetSales=function(){fillOptions(),$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/TargetProgrees?productProvider=11&numMonths=1"}).then(setTargetSales,errorCallBack)},$scope.drawToCanvas=function(){document.getElementById("insertCanvas").innerHTML="<canvas  class='chart' id='canvasData' style='height:395px;width:830px;marign-left:29px;'></canvas>";var responce=$scope.targetInfor,drawItems=[],index=0,i=0;for(var tmep in responce.data){var check=document.getElementById("checkbox"+responce.data[index].ProductID).checked;check===!0&&(i++,drawItems.push(responce.data[index])),index++}var labels=[],sales=[],target=[],counter=0;for(var v in drawItems){var temp=drawItems[counter];labels.push(temp.name),sales.push(temp.currentSales),target.push(temp.targetSales),counter++}var areaChartData={labels:labels,datasets:[{label:"Sales",fillColor:"rgba(210, 214, 222, 1)",strokeColor:"rgba(210, 214, 222, 1)",pointColor:"rgba(210, 214, 222, 1)",pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:sales},{label:"Target",fillColor:"rgba(210, 214, 222, 1)",strokeColor:"rgba(210, 214, 222, 1)",pointColor:"rgba(210, 214, 222, 1)",pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:target}]};document.getElementById("canvasData").innerHTML=0;var barChartCanvas=$("#canvasData").get(0).getContext("2d"),barChart=new Chart(barChartCanvas),barChartData=areaChartData;barChartData.datasets[1].fillColor="#00a65a",barChartData.datasets[1].strokeColor="#00a65a",barChartData.datasets[1].pointColor="#00a65a";var barChartOptions={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:8,isFixedWidth:!1,barWidth:10,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',responsive:!0,maintainAspectRatio:!0};barChartOptions.datasetFill=!1,barChart.Bar(barChartData,barChartOptions)};var drawCompareProducts=function(){var labels=[],p1=[],p2=[],counter=0;alert("compare product");for(var t in $scope.product1data.predictions)p1.push($scope.product1data.predictions[counter]),counter++;counter=0;for(var y in $scope.product2data.predictions)p2.push($scope.product2data.predictions[counter]),counter++,labels.push("2016 - "+counter);var color1="#d35400",color2="#f1c40f",areaChartData={labels:labels,datasets:[{label:"Sales",fillColor:color1,strokeColor:color1,pointColor:color1,pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:color1,data:p1},{label:"Target",fillColor:color2,strokeColor:color2,pointColor:color2,pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:color2,data:p2}]},barChartCanvas=$("#canvasData").get(0).getContext("2d"),barChart=new Chart(barChartCanvas),barChartData=areaChartData,barChartOptions={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:10,isFixedWidth:!1,barWidth:15,barDatasetSpacing:5,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',responsive:!0,maintainAspectRatio:!0};barChartOptions.datasetFill=!1,barChart.Bar(barChartData,barChartOptions)};$scope.compareProuctsCanvas=function(){fillOptions(),document.getElementById("insertCanvas").innerHTML="<canvas  class='chart' id='canvasData' style='height:395px;width:840px;marign-left:29px;'></canvas>";for(var drawItems=[],index=0,i=0,productlist=$scope.itemsData.data,found=0,prod=0;prod<productlist.length||0===found;prod++){var check=document.getElementById("checkbox"+productlist[index].ProductID).checked;check===!0&&(i++,found++,alert(productlist[index].ProductID),drawItems.push(productlist[index].ProductID)),index++}$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/getProductSalesPredictions?productID="+drawItems[0]+"&numPredictions=5"}).then(setCompareProduct1,errorCallBack),$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/getProductSalesPredictions?productID="+drawItems[1]+"&numPredictions=5"}).then(setCompareProduct2,errorCallBack)};$scope.CompareProductTyeSales=function(){fillProductSales(),$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/getProductList"}).then(saveItemInformartion,errorCallBack)},$scope.ForecastProductSales=function(){},$scope.CompareProductTypeForecast=function(){$http({method:"GET",url:"http://nanofinapibeta.azurewebsites.net/api/ReportsMaster/getProductList"}).then(saveItemInformartion,errorCallBack)}}]),angular.module("myApp").controller("dashboard",["$scope","$http",function($scope,$http){var Vmaps,BestProductSuccess=function(responce){var data=responce.data,currentBest=data[0],currentWorst=data[0],counter=0;for(var p in data)parseInt(responce.data[counter].overallUsage)>parseInt(currentBest.overallUsage)?currentBest=data[counter]:parseInt(responce.data[counter].overallUsage)<parseInt(currentWorst.overallUsage)&&(currentWorst=data[counter]),counter++;$scope.bestProduct=currentBest,$scope.worstProduct=currentWorst},getSales=function(response){$scope.numOverallSales=response.data.numOverallSales,$scope.mySales=response.data.mySales,$scope.MarketShare=100*$scope.mySales/$scope.numOverallSales},getMemeber=function(responce){$scope.memebers=responce.data},successCallBack=function(response){$scope.insuranceProductList=response.data;var mapMarkers=[],details=response.data,counter=0;for(var p in details){var value="vouchers"+String(response.data[counter].voucherSent)+"sent at"+response.data[counter].address.split(":")[2];mapMarkers.push({latLng:[parseFloat(response.data[counter].address.split(":")[0]),parseFloat(response.data[counter].address.split(":")[1])],name:value}),counter++}Vmaps=$("#world-map-markers").vectorMap({map:"world_mill_en",normalizeFunction:"polynomial",hoverOpacity:.7,hoverColor:!1,zoomMin:1,backgroundColor:"transparent",regionStyle:{initial:{fill:"rgba(210, 214, 222, 1)","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{"fill-opacity":.7,cursor:"pointer"},selected:{fill:"yellow"},selectedHover:{}},markerStyle:{initial:{fill:"#00a65a",stroke:"#111"}},markers:mapMarkers});var bestArea=response.data[0],worstArea=response.data[0];counter=0;for(var v in response.data)parseInt(response.data[counter].voucherSent)>parseInt(bestArea.voucherSent)?bestArea=response.data[counter]:parseInt(response.data[counter].voucherSent)<parseInt(worstArea.voucherSent)&&(worstArea=response.data[counter]),counter++;$scope.bestArea=bestArea,$scope.worstArea=worstArea,$scope.bestArea.address=String(bestArea.address).split(":")[2],$scope.worstArea.address=String(worstArea.address).split(":")[2]},getUnprocessedApplications=function(responce){$scope.unprocessedApplications=responce.data},errorCallBack=function(response){$scope.insuranceProductList=response.data};$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/Reports/getBestSellingProduct"}).then(BestProductSuccess,errorCallBack),$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/Reports/getBestReseller"}).then(successCallBack,errorCallBack),$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/Reports/getMembers?ProviderID=11"}).then(getMemeber,errorCallBack),$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/Reports/getOverallPurchases?Provider_ID=11"}).then(getSales,errorCallBack),$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/Reports/getNumberOfUnprocessedApplications?ProviderID=11"}).then(getUnprocessedApplications,errorCallBack)}]),angular.module("myApp").controller("viewInsuranceProducts",["$scope","$http",function($scope,$http){var errorCallBack=function(response){$scope.insuranceProductList=response.data},successCallBack=function(response){$scope.insuranceProductList=response.data;var Asset=[],Travel=[],Legal=[],Medical=[],Funeral=[],ValueAdded=[];data=response.data;for(var c=0;c<data.length;c++)"Asset"==response.data[c].typeOfInsurance&&Asset.push(data[c]),"Travel"==response.data[c].typeOfInsurance&&Travel.push(data[c]),"Legal"==response.data[c].typeOfInsurance&&Legal.push(data[c]),"Medical"==response.data[c].typeOfInsurance&&Medical.push(data[c]),"Funeral"==response.data[c].typeOfInsurance&&Funeral.push(data[c]),"Value Added Services"==response.data[c].typeOfInsurance&&ValueAdded.push(data[c]);$scope.Asset=Asset,$scope.Travel=Travel,$scope.Legal=Legal,$scope.Medical=Medical,$scope.Funeral=Funeral,$scope.valueAdded=ValueAdded};$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/insuranceManager/Getinsuranceproducts?ProductProviderID=11"}).then(successCallBack,errorCallBack)}]),angular.module("myApp").controller("processApplications",["$scope","$http","$compile",function($scope,$http,$compile){function addRowHandlers(){var table=document.getElementById("tblApplications"),rows=table.getElementsByTagName("tr");for(i=1;i<rows.length-1;i++){var currentRow=table.rows[i],createClickHandler=function(row){return function(){var cell=row.getElementsByTagName("td")[0],id=cell.innerHTML;$scope.viewModal(id)}};currentRow.onclick=createClickHandler(currentRow)}}function findID(insuranceProductID){for(var r=0;r<unprocessedList.length;r++)if(unprocessedList[r].activeProductID==insuranceProductID)return id=insuranceProductID,unprocessedList[r]}var table,unprocessedList,lastPolicyDOc,id;angular.element(document).ready(function(){table=$("#tblApplications").DataTable({paging:!0,lengthChange:!1,searching:!0,ordering:!0,info:!0,autoWidth:!1,columns:[{data:"activeProductID"},{data:"customerIDNo"},{data:"customerName"},{data:"address"},{data:"InsurnceName"},{data:"startdate"}]})});var errorCallBack=function(response){$scope.uprocessedApplications=response.data},successCallBack=function(response,storage){unprocessedList=response.data.unprocessed,lastPolicyDOc=response.data.lastestPolicyNo,
table.rows.add(unprocessedList),table.draw(),addRowHandlers()};$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/insuranceManager/getUnprocessedApplications?ProductProviderID=11"}).then(successCallBack,errorCallBack),$scope.viewModal=function(index){if(null!==index){var unprocessedApplication=findID(index);$scope.selectedApplication=unprocessedApplication;var html="";html+="<div class='modal fade' id='myModal' tabindex='-1' role='dialog' aria-labelledby='myModalLabel'>",html+="<div class='modal-dialog' role='document'>",html+="<div class='modal-content'>",html+="<div class='modal-header'>",html+="<button type='button' class='close' data-dismiss='modal' aria-label='Close'><span aria-hidden='true'>&times;</span></button>",html+="<h4 class='modal-title' id='myModalLabel'>"+unprocessedApplication.customerName+"'s Insurance Application </h4>",html+="</div>",html+="<div class='modal-body'>",html+="<div class='row'> <div class='col-sm-5 col-sm-push-6'>    <p style='text-align: right'><strong>Lastest Policy#:"+lastPolicyDOc+" </strong<></p> </div></div>",html+="<div class='row'>",html+="<div class='form-group'>",html+="<label for='txtIDno' class='col-sm-3 control-label'>ID</label>",html+="<div class='col-sm-8'>",html+="<input type='text' class='form-control' value='"+unprocessedApplication.customerIDNo+"' disabled>",html+="</div>",html+="</div>",html+="</div>",html+="<div class='row'>",html+="<div class='form-group'>",html+="<br />",html+="<label for='txtAddress' class='col-sm-3 control-label'>Address</label>",html+="<div class='col-sm-8'>",html+="<input type='text' class='form-control' id='txtAddress' value='"+unprocessedApplication.address+"' disabled>",html+="</div>",html+="<br />",html+="</div>",html+="</div>",html+="<div class='row'>",html+="<div class='form-group'>",html+="<br />",html+="<label for='txtProductPurchase' class='col-sm-3 control-label'>Product Purchased</label>",html+="<div class='col-sm-8'>",html+="<input type='text' class='form-control' id='txtProductPurchase' value='"+unprocessedApplication.InsurnceName+"' disabled>",html+="</div>",html+="</div>",html+="</div>",html+="<div class='row'>",html+="<div class='form-group'>",html+="<br />",html+="<label for='txtStartDate' class='col-sm-3 control-label'>Product Purchased</label>",html+="<div class='col-sm-8'>",html+="<input type='text' class='form-control' id='txtStartDate' value='"+unprocessedApplication.startdate+"' disabled>",html+="</div>",html+="</div>",html+="</div>",html+="<div class='row'>",html+="<br />",html+="<div id='frmPolicyDoc' class='form-group'>",html+="<label for='txtPolicyNo' class='col-sm-3 control-label'>Assign Policy No</label>",html+="<div class='col-sm-8'>",html+="<input type='text' class='form-control' id='txtPolicyNo'>",html+="<div id='txtError'></div>",html+="</div>",html+="</div>",html+="</div>",html+="</div>",html+="<div class='modal-footer'>",html+="<div class='row'>",html+="<div class='col-sm-4 '>",html+="<button type='button' class='btn btn-danger ' data-dismiss='modal'>Decline Application</button>",html+="</div>",html+="<div class='col-sm-4 col-sm-push-4'>",html+="<button type='button' id='btnModalApprove' class='btn btn-success'>Approve Application</button>",html+="</div>",html+="</div>",html+="</div>",html+="</div>",html+="</div>",html+="</div>",$("#processApplicationModal").html(html),$("#myModal").modal(),document.getElementById("txtPolicyNo").required=!0;var invalidInput=function(errormessage){document.getElementById("frmPolicyDoc").className=" form-group has-error",document.getElementById("txtError").innerHTML=" <span class='help-block'>"+errormessage+"</span>"},modalButton=document.getElementById("btnModalApprove");modalButton.onclick=function(){var newPolicyNo=document.getElementById("txtPolicyNo").value;return""===newPolicyNo?void invalidInput("please enter a policy number"):void $http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/insuranceManager/isPolicyNumberUnique?policyNo="+newPolicyNo}).then(function(responce){if(responce.data===!1)invalidInput("The policy number entered already exist");else{var processApp={providerID:11,activeproductID:id,policyNo:newPolicyNo.toString()},req={method:"POST",url:"http://nanofinapi.azurewebsites.net/api/insuranceManager/ProcessInsuranceProduct",headers:{"Content-Type":"application/json; charset=UTF-8"},data:JSON.stringify(processApp)};$http(req).then(function(responce){Boolean.valueOf(responce.data)===!0&&alert("happy!!!"),$("#myModal").modal("hide")})}})}}}}]),angular.module("myApp").controller("productManagement",["$scope","$http",function($scope,$http){var ID,insuranceProdID,VID=location.search.split("vid=")[1],PerrorCallBack=function(response){$scope.product=response.data},PsuccessCallBack=function(response){$scope.product=response.data,document.getElementById("sltAvailable").value=$scope.product.isAvailableForPurchase,$scope.pageHeader=$scope.product.productName,ID=$scope.product.Product_ID};$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/insuranceManager/Getproduct/"+VID}).then(PsuccessCallBack,PerrorCallBack);var IPerrorCallBack=function(response){$scope.InsuranceProduct=response.data},IPsuccessCallBack=function(response){$scope.InsuranceProduct=response.data,insuranceProdID=$scope.InsuranceProduct.InsuranceProduct_ID,document.getElementById("sltInsuranceType").value=$scope.InsuranceProduct.InsuranceType_ID,document.getElementById("sltInsuranceType").value=$scope.InsuranceProduct.InsuranceType_ID};$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/insuranceManager/Getinsuranceproduct?ProductProviderID=11&InsuranceProduct_ID=91"}).then(IPsuccessCallBack,IPerrorCallBack),$scope.submitProductChanges=function(){var xhr=new XMLHttpRequest;xhr.open("PUT","http://nanofinapi.azurewebsites.net/api/insuranceManager/Putproduct/"+ID,!0),xhr.setRequestHeader("Content-Type","application/json; charset=UTF-8"),xhr.send(JSON.stringify($scope.product)),xhr.onloadend=function(){}},$scope.submitInsuranceProductChanges=function(){var xhr=new XMLHttpRequest;xhr.open("PUT","http://nanofinapi.azurewebsites.net/api/insuranceManager/Putinsuranceproduct?InsuranceProduct_ID="+insuranceProdID,!0),xhr.setRequestHeader("Content-Type","application/json; charset=UTF-8"),xhr.send(JSON.stringify($scope.InsuranceProduct)),xhr.onloadend=function(){}},$scope.SendFile=function(){var f=document.getElementById("file1").files[0],r=new FileReader;r.onloadend=function(e){e.target.result;alert(e.target.fileName)},alert(e.target.fileName),r.readAsBinaryString(f)}}]),angular.module("myApp").controller("reportsController",["$scope","$http","$compile",function($scope,$http,$compile){var table,unprocessedList;angular.element(document).ready(function(){table=$("#tblApplications").DataTable({paging:!0,lengthChange:!1,searching:!0,ordering:!0,info:!0,autoWidth:!1,columns:[{data:"index"},{data:"month"},{data:"NumberofPurchases"},{data:"unitsSold"},{data:"OverallSales"}]})});var errorCallBack=function(response){$scope.uprocessedApplications=response.data},successCallBack=function(response){unprocessedList=response.data,table.rows.add(unprocessedList),table.draw()};$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/Reports/getInvoices?providerID=11"}).then(successCallBack,errorCallBack);var ProductSales=function(response){var labels=[],values=[];labels.push(""),values.push(1);var counter=0;for(var v in response.data)labels.push(response.data[counter].name),values.push(response.data[counter].overallUsage),counter++;var areaChartData={labels:labels,datasets:[{label:labels,fillColor:"rgba(210, 214, 222, 1)",strokeColor:"rgba(210, 214, 222, 1)",pointColor:"rgba(210, 214, 222, 1)",pointStrokeColor:"#c1c7d1",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:values}]},barChartCanvas=$("#barChart").get(0).getContext("2d"),barChart=new Chart(barChartCanvas),barChartData=areaChartData;barChartData.datasets[0].fillColor="#00a65a",barChartData.datasets[0].strokeColor="#00a65a",barChartData.datasets[0].pointColor="#00a65a";var barChartOptions={scaleFontSize:0,showXAxisLabel:!1,scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:10,legend:{display:!1},tooltips:{enabled:!1},barDatasetSpacing:50,responsive:!0,maintainAspectRatio:!0};barChartOptions.datasetFill=!0,barChart.Bar(barChartData,barChartOptions)};$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/Reports/getBestSellingProduct"}).then(ProductSales,errorCallBack)}]),angular.module("myApp").controller("validateUsers",["$scope","$http","$compile",function($scope,$http,$compile){var table,unprocessedList;angular.element(document).ready(function(){table=$("#tblApplications").DataTable({paging:!0,lengthChange:!1,searching:!0,ordering:!0,info:!0,autoWidth:!1,columns:[{data:"userID"},{data:"brankNo"},{data:"name"},{data:"IDNumber"},{data:"bankName"},{data:"accountNo"},{data:"address"},{data:"contactInfo"}]})});var errorCallBack=function(response){$scope.uprocessedApplications=response.data},successCallBack=function(response){unprocessedList=response.data;var counter=0;for(var p in unprocessedList)unprocessedList[counter].brankNo="Pending",counter++;table.rows.add(unprocessedList),table.draw()};$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/Validator/getUnValidatedUsers"}).then(successCallBack,errorCallBack)}]),angular.module("myApp").controller("customerCtrl",["$scope","$http","$log",function($scope,$http,$log){$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/TestManager/Getinsurancetype"}).then(function(response){$scope.insuranceTypes=response.data},function(){$log.info("ERROR:"+reason)})}]),angular.module("myApp").controller("insuranceProd",["$scope","$http",function($scope,$http){var errorCallBack=function(response){$scope.insuranceProductList=response.data},successCallBack=function(response){$scope.insuranceProductList=response.data};$http({method:"GET",url:"http://nanofinapi.azurewebsites.net/api/insuranceManager/Getinsuranceproducts?ProductProviderID=11"}).then(successCallBack,errorCallBack)}]),angular.module("myApp").controller("loginCtrl",["$scope","$http",function($scope,$http){$scope.login=function(){alert("I am an alert box!")}}]),angular.module("myApp").controller("mapController",["$scope","$http","NgMap",function($scope,$http,NgMap){$scope.googleMapsUrl="https://maps.googleapis.com/maps/api/js?key=AIzaSyDaVSsJenH6dgcBdRY4pWilPBFIDTsY8us",NgMap.getMap().then(function(map){})}]),angular.module("myApp").controller("resellerCtrl",["$scope","$http","$log",function($scope,$http,$log){var errorCallBack=function(response){$log.info("ERROR:"+reason)},successCallBack=function(response){$log.info("SUCCESS:"+reason)};$scope.buyBulk=function(amount,resellerID){$http({method:"POST",url:"http://localhost:10812/api/WalletHandler/buyBulkVoucher?userID=33&resellerID=1&BulkVoucherAmount="+amount+"&transactionType_ID=1"}).then(successCallBack,errorCallBack)},$scope.sendBulkVoucher=function(amount,resellerUserID,recipienDetails){$http({method:"POST",url:"http://localhost:10812/api/WalletHandler/sendBulkVoucher?resellerUserID="+resellerUserID+"&recipientDetails="+recipienDetails+"&transferAmount="+amount}).then(successCallBack,errorCallBack)}}]),function(){"use strict";function FastClick(layer,options){function bind(method,context){return function(){return method.apply(context,arguments)}}var oldOnClick;if(options=options||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=options.touchBoundary||10,this.layer=layer,this.tapDelay=options.tapDelay||200,this.tapTimeout=options.tapTimeout||700,!FastClick.notNeeded(layer)){for(var methods=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],context=this,i=0,l=methods.length;i<l;i++)context[methods[i]]=bind(context[methods[i]],context);deviceIsAndroid&&(layer.addEventListener("mouseover",this.onMouse,!0),layer.addEventListener("mousedown",this.onMouse,!0),layer.addEventListener("mouseup",this.onMouse,!0)),layer.addEventListener("click",this.onClick,!0),layer.addEventListener("touchstart",this.onTouchStart,!1),layer.addEventListener("touchmove",this.onTouchMove,!1),layer.addEventListener("touchend",this.onTouchEnd,!1),layer.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(layer.removeEventListener=function(type,callback,capture){var rmv=Node.prototype.removeEventListener;"click"===type?rmv.call(layer,type,callback.hijacked||callback,capture):rmv.call(layer,type,callback,capture)},layer.addEventListener=function(type,callback,capture){var adv=Node.prototype.addEventListener;"click"===type?adv.call(layer,type,callback.hijacked||(callback.hijacked=function(event){event.propagationStopped||callback(event)}),capture):adv.call(layer,type,callback,capture)}),"function"==typeof layer.onclick&&(oldOnClick=layer.onclick,layer.addEventListener("click",function(event){oldOnClick(event)},!1),layer.onclick=null)}}var deviceIsWindowsPhone=navigator.userAgent.indexOf("Windows Phone")>=0,deviceIsAndroid=navigator.userAgent.indexOf("Android")>0&&!deviceIsWindowsPhone,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent)&&!deviceIsWindowsPhone,deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS [6-7]_\d/.test(navigator.userAgent),deviceIsBlackBerry10=navigator.userAgent.indexOf("BB10")>0;FastClick.prototype.needsClick=function(target){switch(target.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(target.disabled)return!0;break;case"input":if(deviceIsIOS&&"file"===target.type||target.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(target.className)},FastClick.prototype.needsFocus=function(target){switch(target.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(target.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!target.disabled&&!target.readOnly;default:return/\bneedsfocus\b/.test(target.className)}},FastClick.prototype.sendClick=function(targetElement,event){var clickEvent,touch;document.activeElement&&document.activeElement!==targetElement&&document.activeElement.blur(),touch=event.changedTouches[0],clickEvent=document.createEvent("MouseEvents"),clickEvent.initMouseEvent(this.determineEventType(targetElement),!0,!0,window,1,touch.screenX,touch.screenY,touch.clientX,touch.clientY,!1,!1,!1,!1,0,null),clickEvent.forwardedTouchEvent=!0,targetElement.dispatchEvent(clickEvent)},FastClick.prototype.determineEventType=function(targetElement){return deviceIsAndroid&&"select"===targetElement.tagName.toLowerCase()?"mousedown":"click"},FastClick.prototype.focus=function(targetElement){var length;deviceIsIOS&&targetElement.setSelectionRange&&0!==targetElement.type.indexOf("date")&&"time"!==targetElement.type&&"month"!==targetElement.type?(length=targetElement.value.length,targetElement.setSelectionRange(length,length)):targetElement.focus()},FastClick.prototype.updateScrollParent=function(targetElement){var scrollParent,parentElement;if(scrollParent=targetElement.fastClickScrollParent,!scrollParent||!scrollParent.contains(targetElement)){parentElement=targetElement;do{if(parentElement.scrollHeight>parentElement.offsetHeight){scrollParent=parentElement,targetElement.fastClickScrollParent=parentElement;break}parentElement=parentElement.parentElement}while(parentElement)}scrollParent&&(scrollParent.fastClickLastScrollTop=scrollParent.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(eventTarget){return eventTarget.nodeType===Node.TEXT_NODE?eventTarget.parentNode:eventTarget},FastClick.prototype.onTouchStart=function(event){var targetElement,touch,selection;if(event.targetTouches.length>1)return!0;if(targetElement=this.getTargetElementFromEventTarget(event.target),touch=event.targetTouches[0],deviceIsIOS){if(selection=window.getSelection(),selection.rangeCount&&!selection.isCollapsed)return!0;if(!deviceIsIOS4){if(touch.identifier&&touch.identifier===this.lastTouchIdentifier)return event.preventDefault(),!1;this.lastTouchIdentifier=touch.identifier,this.updateScrollParent(targetElement)}}return this.trackingClick=!0,this.trackingClickStart=event.timeStamp,this.targetElement=targetElement,this.touchStartX=touch.pageX,this.touchStartY=touch.pageY,event.timeStamp-this.lastClickTime<this.tapDelay&&event.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(event){var touch=event.changedTouches[0],boundary=this.touchBoundary;return Math.abs(touch.pageX-this.touchStartX)>boundary||Math.abs(touch.pageY-this.touchStartY)>boundary},FastClick.prototype.onTouchMove=function(event){return!this.trackingClick||((this.targetElement!==this.getTargetElementFromEventTarget(event.target)||this.touchHasMoved(event))&&(this.trackingClick=!1,this.targetElement=null),!0)},FastClick.prototype.findControl=function(labelElement){return void 0!==labelElement.control?labelElement.control:labelElement.htmlFor?document.getElementById(labelElement.htmlFor):labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(event){var forElement,trackingClickStart,targetTagName,scrollParent,touch,targetElement=this.targetElement;if(!this.trackingClick)return!0;if(event.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(event.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=event.timeStamp,trackingClickStart=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(touch=event.changedTouches[0],targetElement=document.elementFromPoint(touch.pageX-window.pageXOffset,touch.pageY-window.pageYOffset)||targetElement,targetElement.fastClickScrollParent=this.targetElement.fastClickScrollParent),targetTagName=targetElement.tagName.toLowerCase(),"label"===targetTagName){if(forElement=this.findControl(targetElement)){if(this.focus(targetElement),deviceIsAndroid)return!1;targetElement=forElement}}else if(this.needsFocus(targetElement))return event.timeStamp-trackingClickStart>100||deviceIsIOS&&window.top!==window&&"input"===targetTagName?(this.targetElement=null,!1):(this.focus(targetElement),this.sendClick(targetElement,event),deviceIsIOS&&"select"===targetTagName||(this.targetElement=null,event.preventDefault()),!1);return!(!deviceIsIOS||deviceIsIOS4||(scrollParent=targetElement.fastClickScrollParent,!scrollParent||scrollParent.fastClickLastScrollTop===scrollParent.scrollTop))||(this.needsClick(targetElement)||(event.preventDefault(),this.sendClick(targetElement,event)),!1)},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(event){return!this.targetElement||(!!event.forwardedTouchEvent||(!event.cancelable||(!(!this.needsClick(this.targetElement)||this.cancelNextClick)||(event.stopImmediatePropagation?event.stopImmediatePropagation():event.propagationStopped=!0,event.stopPropagation(),event.preventDefault(),!1))))},FastClick.prototype.onClick=function(event){var permitted;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===event.target.type&&0===event.detail||(permitted=this.onMouse(event),permitted||(this.targetElement=null),permitted)},FastClick.prototype.destroy=function(){var layer=this.layer;deviceIsAndroid&&(layer.removeEventListener("mouseover",this.onMouse,!0),layer.removeEventListener("mousedown",this.onMouse,!0),layer.removeEventListener("mouseup",this.onMouse,!0)),layer.removeEventListener("click",this.onClick,!0),layer.removeEventListener("touchstart",this.onTouchStart,!1),layer.removeEventListener("touchmove",this.onTouchMove,!1),layer.removeEventListener("touchend",this.onTouchEnd,!1),layer.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(layer){function getChromeVersion(){var raw=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!raw&&parseInt(raw[2],10)}var metaViewport,chromeVersion,blackberryVersion,firefoxVersion;if("undefined"==typeof window.ontouchstart)return!0;if(chromeVersion=getChromeVersion()){if(!deviceIsAndroid)return!0;if(metaViewport=document.querySelector("meta[name=viewport]")){if(metaViewport.content.indexOf("user-scalable=no")!==-1)return!0;if(chromeVersion>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(deviceIsBlackBerry10&&(blackberryVersion=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),blackberryVersion[1]>=10&&blackberryVersion[2]>=3&&(metaViewport=document.querySelector("meta[name=viewport]")))){if(metaViewport.content.indexOf("user-scalable=no")!==-1)return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===layer.style.msTouchAction||"manipulation"===layer.style.touchAction||(firefoxVersion=20,!!(firefoxVersion>=27&&(metaViewport=document.querySelector("meta[name=viewport]"),metaViewport&&(metaViewport.content.indexOf("user-scalable=no")!==-1||document.documentElement.scrollWidth<=window.outerWidth)))||("none"===layer.style.touchAction||"manipulation"===layer.style.touchAction))},FastClick.attach=function(layer,options){return new FastClick(layer,options)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return FastClick}):"undefined"!=typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick}();